<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Parque de Estacionamento Inteligente</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #e5e5e5;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #2c3e50;
        }
        .parque {
            position: relative;
            width: 700px;
            margin: 40px auto;
            background: #2d3436;
            border: 5px solid #636e72;
            padding: 40px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .vaga-container {
            position: relative;
            width: 120px;
            height: 200px;
            background-color: #bdc3c7;
            border: 3px dashed white;
            margin: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #2c3e50;
            font-weight: bold;
        }
        .sensor-indicador {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: green;
            border: 2px solid white;
        }
        .ocupada-indicador {
            background-color: red;
        }
        .entradas {
            text-align: center;
            margin-top: 40px;
        }
        .entradas img {
            max-width: 200px;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            margin: 10px;
        }
        .acoes {
            text-align: center;
            margin-top: 30px;
        }
        .acoes a {
            display: inline-block;
            padding: 10px 20px;
            background-color: #2980b9;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 0 10px;
        }
        .acoes a:hover {
            background-color: #1c5980;
        }
    </style>
</head>
<body>
    <h1>Parque de Estacionamento Inteligente</h1>

    <div class="parque" id="vagas-lista">
        {% for vaga in vagas %}
            <div class="vaga-container">
                <div class="sensor-indicador {% if vaga %}ocupada-indicador{% endif %}"></div>
                Vaga {{ loop.index }}
            </div>
        {% endfor %}
    </div>

    <div class="entradas">
        <h2>Ãšltimas Entradas</h2>
        {% for imagem, data in entradas %}
            <p>{{ data }}</p>
            <img src="/{{ imagem }}">
        {% endfor %}
    </div>

    <div class="acoes">
        <a href="/entrada">Simular Entrada</a>
        <a href="/limpar_fotos">Limpar Registos</a>
    </div>

    <script>
    function atualizarVagas() {
        fetch('/api/vagas')
            .then(response => response.json())
            .then(data => {
                const sensores = document.querySelectorAll('.sensor-indicador');
                data.forEach((ocupada, index) => {
                    if (ocupada) {
                        sensores[index].classList.add('ocupada-indicador');
                    } else {
                        sensores[index].classList.remove('ocupada-indicador');
                    }
                });
            });
    }

    setInterval(atualizarVagas, 1000);
    </script>
</body>
</html>